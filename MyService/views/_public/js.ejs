<script>
    (function () {
        if (!('placeholder' in document.createElement('input')) && location.pathname != '/msg')
            location.href = '/msg?notSupportedBrowser=true';
    })();
</script>
<script type="text/javascript">
    window._namespace = {};

    window.namespace = function (namespace, factory) {
        var list = namespace.split('.');
        var ns = window[list[0]];
        if (factory) {
            if (list.length == 1) {
                if (ns)
                    throw new Error('namespace [' + namespace + '] is exist!');
                ns = window[list[0]] = _namespace[list[0]] = factory;
            } else {
                if (!ns)
                    ns = window[list[0]] = _namespace[list[0]] = {};
                for (var i = 1; i < list.length; i++) {
                    var ns_next = ns[list[i]];
                    if (!ns_next) {
                        if (i == list.length - 1)
                            ns[list[i]] = factory;
                        else
                            ns[list[i]] = {};
                    }
                    else if (i == list.length - 1) {
                        throw new Error('namespace [' + namespace + '] is exist!');
                    }
                    ns = ns[list[i]];
                }
            }
        } else {
            let notExist = false;
            var i = 0;
            if (!ns)
                notExist = true;
            else {
                i = 1;
                for (; i < list.length; i++) {
                    if (!(ns = ns[list[i]])) {
                        notExist = true;
                        break;
                    }
                }
            }
            if (notExist)
                throw new Error('namespace [' + namespace + '][' + list.slice(0, i + 1).join('.') + '] is null!');
        }
        return ns;
    };
</script>
<% if(requirejs){ %>
<script type="text/javascript" src="/js/plugins/require.js"></script>
<script type="text/javascript">
    requirejs.config({
        baseUrl: '/js',
        paths: {
            'jquery': 'plugins/jquery-2.1.1.min',
            'jquery.cookie': 'plugins/jquery.cookie',
            'jquery-ui': 'jquery-ui.min',
            'bootstrap': 'plugins/bootstrap.min',
            'ejs': 'plugins/ejs.min',
            'spark-md5': 'plugins/spark-md5.min',
            'socket.io': 'plugins/socket.io/socket.io',
            'WdatePicker': 'plugins/My97DatePicker/WdatePicker.io',
            'underscore': 'plugins/underscore-min',

            'config': 'config',
            'main': '<%= env %>/_main',
            'common': '<%= env %>/common',
            'my.enum': '<%= env %>/my.enum',
            'sign': '<%= env %>/sign',
            'socket': '<%= env %>/socket',
            'my.interface': '<%= env %>/my.interface',
            'my.vaild': '<%= env %>/my.vaild',
        },
        shim: {
            'bootstrap': {
                deps: ['jquery'],
                exports: 'bootstrap'
            },
            'config': {
                exports: 'config'
            },
            'main': {
                exports: 'main'
            },
            'common': {
                exports: 'common'
            },
            'my.enum': {
                exports: 'my.enum'
            },
            'sign': {
                exports: 'sign'
            },
            'socket': {
                exports: 'socket'
            },
            'my.interface': {
                exports: 'my.interface'
            },
            'my.vaild': {
                exports: 'my.vaild'
            }
        }
    });
    require(['jquery', 'underscore', 'my.enum'], function ($, _) {
        $(function () {
            var myEnum = require('my.enum');
            console.log(myEnum)
        })
    })
</script>
<% }else{ %>
<script type="text/javascript" src="/js/plugins/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="/js/plugins/jquery.cookie.js"></script>
<script type="text/javascript" src="/js/plugins/jquery-ui.min.js"></script>
<script type="text/javascript" src="/js/plugins/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/plugins/ejs.min.js"></script>
<script type="text/javascript" src="/js/plugins/spark-md5.min.js"></script>
<script type="text/javascript" src="/js/plugins/socket.io/socket.io.js"></script>
<script type="text/javascript" src="/js/plugins/My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="/js/plugins/underscore-min.js"></script>

<script type="text/javascript">
    //临时
    window.require = function () {
    };
</script>
<script type="text/javascript" src="/js/config.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/_main.js?v=<%= version %>"></script>

<script type="text/javascript" src="/js/<%= env %>/common.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/my.enum.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/sign.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/socket.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/my.interface.js?v=<%= version %>"></script>
<script type="text/javascript" src="/js/<%= env %>/my.vaild.js?v=<%= version %>"></script>
<script type="text/javascript">
    $(function () {
        main.init();
    });
</script>
<% } %>